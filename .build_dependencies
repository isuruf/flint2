#! /bin/sh
absolute_path(){
   dirlist="$1"
   retval=""
   for dir in $dirlist; do
      case $dir in
        /*) dir=$dir;;
        *) dir=$PWD/$dir;;
      esac
      retval=$retval" "$dir
   done
   echo $retval
}

deps_dir=$(absolute_path "deps")
echo $deps_dir

wget http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz
tar -xf yasm-1.3.0.tar.gz
cd yasm-1.3.0
./configure --prefix=$deps_dir
make -j4 > /dev/null 2>&1
make install > /dev/null 2>&1
cd ..

wget http://mpir.org/mpir-3.0.0.tar.bz2
tar -xf mpir-3.0.0.tar.bz2
cd mpir-3.0.0
./configure ABI=$ABI --enable-gmpcompat --with-yasm=$deps_dir/bin/yasm --prefix=$deps_dir
make -j4 > /dev/null 2>&1
make install > /dev/null 2>&1
cd ..

wget http://www.mpfr.org/mpfr-current/mpfr-3.1.5.tar.bz2
tar -xf mpfr-3.1.5.tar.bz2
cd mpfr-3.1.5
./configure ABI=$ABI --with-gmp=$deps_dir --prefix=$deps_dir
make -j4 > /dev/null 2>&1
make install > /dev/null 2>&1
cd ..

echo "int flint_test_multiplier(){return 1;}" > test_helpers.c

